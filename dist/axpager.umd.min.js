!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).axpager={})}(this,(function(e){"use strict";var t={JSON:"application/json",URL_ENCODED:"application/x-www-form-urlencoded",FORM_DATA:"multipart/form-data"},a=function(){function e(){}return e.prototype.request=function(e,a,i){var n=this;return new Promise((function(s,r){n.xhr&&4!==n.xhr.readyState&&n.xhr.abort(),n.xhr=new XMLHttpRequest,n.xhr.responseType="json",Object.keys(i.headers).forEach((function(e){n.xhr.setRequestHeader(e,i.headers[e])})),i.before(n.xhr),n.xhr.onload=function(){4===this.readyState&&this.status>=200&&this.status<300?s(this.response):r(this.status+": "+(this.statusText||"request failed."))},i.timeout&&i.timeout>=0&&(n.xhr.timeout=i.timeout,n.xhr.ontimeout=function(){r("408: request timeout, request wait time > "+this.timeout)}),n.xhr.onerror=function(){r(this.status+": "+(this.statusText||"server error."))};var o=(i.method||"GET").toUpperCase();if("GET"===o){var c=Object.assign({},i.data,a),h=e.includes("?")?"&":"?",u=e+h+new URLSearchParams(c);return n.xhr.open(o,u,!0),void n.xhr.send()}if("POST"===o){if(n.xhr.open(o,e,!0),i.data instanceof FormData){var p=new FormData;return i.data.forEach((function(e,t){return p.set(t,e)})),Object.keys(a).forEach((function(e){return p.set(e,a[e])})),void n.xhr.send(p)}var g=i.headers["Content-Type"]||t.URL_ENCODED;if(g===t.FORM_DATA){var l=new FormData;return Object.keys(i.data).forEach((function(e){return l.set(e,i.data[e])})),Object.keys(a).forEach((function(e){return l.set(e,a[e])})),void n.xhr.send(l)}c=Object.assign({},i.data,a);if(g===t.URL_ENCODED)return void n.xhr.send(new URLSearchParams(c));if(g===t.JSON)return void n.xhr.send(JSON.stringify(c));n.xhr.abort(),r("Not support Content-Type: "+g)}r("Not support "+o+" method.")}))},e}(),i={itemsPerPageLabel:"每页条数 ",firstPageLabel:"第一页",previousPageLabel:"上一页",nextPageLabel:"下一页",lastPageLabel:"最后一页",hidePageSize:!1,showFirstLastButtons:!0,showPageSizeOptions:!0,initPageNumber:1,initPageSize:10,pageRadius:0,pageNumbersType:"button",pageSizeOptions:[10,15,30],ajaxAdapter:new a,getRangeLabel:function(e,t,a,i){return"第".concat(e,"/").concat(a,"页，共").concat(i,"条")},getPageParams:function(e,t){return{page:e,size:t}},getPagedResource:function(e){return{data:e.data,length:e.pager.recordCount}},changes:function(e,t){}},n={method:"GET",data:{},headers:{},timeout:-1,before:function(e){},success:function(e,t,a){},error:function(e){},finish:function(){},filter:function(e,t){return!0}},s='<svg viewBox="0 0 24 24" focusable="false" class="axp-icon"><path d="M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"></path></svg>',r='<svg viewBox="0 0 24 24" focusable="false" class="axp-icon"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg>',o='<svg viewBox="0 0 24 24" focusable="false" class="axp-icon"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg>',c='<svg viewBox="0 0 24 24" focusable="false" class="axp-icon"><path d="M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"></path></svg>',h=function(e,t){void 0===t&&(t={});var a=document.createElement(e);return Object.keys(t).forEach((function(e){a[e]=t[e]})),a},u=Symbol("initDomElements"),p=Symbol("updateActionStatus"),g=Symbol("updateRangeLabel"),l=Symbol("updateCurrent"),f=Symbol("calcPageNumbers"),d=function(){function e(e,t){var a=this;this.config={},this.pageNumberButtons=[],this.previousPage=1,this.currentPage=1,this.length=0,this.size=0,this.pageNumbers=[],this.disabled=!1,this.container=e,this.config=Object.assign({},i,t),this.currentPage=this.config.initPageNumber||1,this.size=this.config.pageSizeOptions.includes(this.config.initPageSize)?this.config.initPageSize:this.config.pageSizeOptions[0]||10,this.actions={selectPageSize:h("SELECT",{className:"axp-select axp-size-options",disabled:!0}),btnFirst:h("BUTTON",{type:"button",title:this.config.firstPageLabel,innerHTML:"".concat(s,'<span class="axp-btn-touch-target"></span>'),className:"axp-btn",disabled:!0}),btnPrev:h("BUTTON",{type:"button",title:this.config.previousPageLabel,innerHTML:"".concat(r,'<span class="axp-btn-touch-target"></span>'),className:"axp-btn",disabled:!0}),btnNext:h("BUTTON",{type:"button",title:this.config.nextPageLabel,innerHTML:"".concat(o,'<span class="axp-btn-touch-target"></span>'),className:"axp-btn",disabled:!0}),btnLast:h("BUTTON",{type:"button",title:this.config.lastPageLabel,innerHTML:"".concat(c,'<span class="axp-btn-touch-target"></span>'),className:"axp-btn",disabled:!0})},this.labels={itemsPerPageLabel:h("SPAN",{className:"axp-label axp-items-per-page"}),rangeLabel:h("SPAN",{className:"axp-label axp-range"})},this.panels={pageSizePanel:h("DIV",{className:"axp-page-size"}),actionsPanel:h("DIV",{className:"axp-range-actions"}),pagesPanel:"select"===this.config.pageNumbersType?h("SELECT",{className:"axp-select axp-page-numbers",disabled:!0}):h("DIV",{className:"axp-pages"})},this.panels.actionsPanel.addEventListener("click",(function(e){if(!a.disabled){var t=e.target;if(null!=t&&("axp-btn-touch-target"===t.className&&(t=t.parentElement),null!=t&&!t.disabled)){var i=a.actions,n=!0,s=a.previousPage;switch(a.previousPage=a.currentPage,t){case i.btnFirst:a.currentPage=1;break;case i.btnPrev:a.currentPage=a.currentPage>1?a.currentPage-1:1;break;case i.btnNext:var r=a.currentPage+1,o=a.pages;a.currentPage=r>o?o:r;break;case i.btnLast:a.currentPage=a.pages;break;default:if("select"!==a.config.pageNumbersType&&a.config.pageRadius>1){var c=a.pageNumberButtons.indexOf(t);if(c>-1){a.currentPage=a.pageNumbers[c];break}}a.previousPage=s,n=!1}n&&(a.config.changes(a.pageEvent,t),a.of(a.target,a.option))}}})),this.actions.selectPageSize.addEventListener("change",(function(e){if(!a.disabled){var t=e.target;if(!t.disabled){a.previousPage=a.currentPage;var i=t.options.selectedIndex;a.size=a.config.pageSizeOptions[i]||10;var n=a.pages;a.currentPage>n&&(a.currentPage=n),a.config.changes(a.pageEvent,e.target),a.of(a.target,a.option)}}})),"select"===this.config.pageNumbersType&&this.config.pageRadius>1&&this.panels.pagesPanel.addEventListener("change",(function(e){if(!a.disabled){var t=e.target;if(!t.disabled){a.previousPage=a.currentPage;var i=t.options.selectedIndex;a.currentPage=a.pageNumbers[i],a.config.changes(a.pageEvent,e.target),a.of(a.target,a.option)}}})),this[u]()}return Object.defineProperty(e.prototype,"pages",{get:function(){if(this.length<=1)return 1;var e=this.length/this.size;if(e<=1)return 1;var t=Math.floor(e);return t===e?t:t+1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageParams",{get:function(){return this.config.getPageParams(this.currentPage,this.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageEvent",{get:function(){var e=this.currentPage*this.size;return{previousPage:this.previousPage,page:this.currentPage,size:this.size,start:(this.currentPage-1)*this.size,end:e>this.length?this.length:e,pages:this.pages,length:this.length}},enumerable:!1,configurable:!0}),e.init=function(t,a){return new e(t,a)},e.prototype.ajax=function(e,t){var a=this;if(!this.disabled){if("string"!=typeof e)throw Error("Request url is required.");this.target=e,this.option=Object.assign({},n,t);var i={method:this.option.method,data:this.option.data,headers:this.option.headers,timeout:this.option.timeout,before:this.option.before};this.config.ajaxAdapter.request(this.target,this.pageParams,i).then((function(e){var t=a.config.getPagedResource(e),i=t.data,n=t.length;a[l](n);var s=a.pageEvent;a.option.success(i,s,a.option.data),a[p](s.page,s.pages,s.length),a[g]()})).catch(this.option.error).finally(this.option.finish)}},e.prototype.resource=function(e,t){var a=this;if(!this.disabled){if(!(e instanceof Array))throw Error("data must be an Array.");this.target=e,this.option=Object.assign({},n,t),this.option.before(null);var i=this.target.filter((function(e){return a.option.filter(e,a.option.data)}));this[l](i.length);var s=this.pageEvent,r=i.slice(s.start,s.end);this.option.success(r,s,this.option.data),this[p](s.page,s.pages,s.length),this[g](),this.option.finish()}},e.prototype.of=function(e,t){if("string"!=typeof e){if(!(e instanceof Array))throw Error(e+" can not be paging.");this.resource(e,t)}else this.ajax(e,t)},e.prototype.refresh=function(){this.of(this.target,this.option)},e.prototype.goto=function(e){if(!this.disabled){if("number"!=typeof e)throw Error("page must be number.");if(this.previousPage=this.currentPage,e<1)this.currentPage=1;else{var t=this.pages;this.currentPage=e>t?t:e}this.refresh()}},e.prototype.disable=function(e){this.disabled=e,this[p](this.currentPage,this.pages,this.length)},e.prototype[f]=function(){if("number"!=typeof this.config.pageRadius)throw Error("pageRadius must be number.");if(this.config.pageRadius<2)return[];var e=this.pages,t=this.currentPage-this.config.pageRadius,a=this.currentPage+this.config.pageRadius;t<=0&&(a-=t-1),a>e&&(t-=a-e-1);var i=[];do{t>0&&t<=e&&i.push(t)}while(++t<a);return i},e.prototype[l]=function(e){var t=this;this.length=e;var a=this.pages;this.currentPage=this.currentPage>a?a:this.currentPage,this.config.pageRadius<2||(this.pageNumbers=this[f](),"select"!==this.config.pageNumbersType?(this.panels.pagesPanel.innerHTML="",this.pageNumberButtons=this.pageNumbers.map((function(e){var a=h("BUTTON",{className:"axp-btn".concat(e===t.currentPage?" axp-btn-current":""),innerHTML:"".concat(e,'<span class="axp-btn-touch-target"></span>')});return t.panels.pagesPanel.appendChild(a),a}))):this.panels.pagesPanel.innerHTML=this.pageNumbers.map((function(e){return"<option ".concat(e===t.currentPage?"selected":"",">").concat(e,"</option>")})).join(""))},e.prototype[u]=function(){var e=this;this.container.innerHTML='<div class="ax-pager"></div>',this.actions.selectPageSize.innerHTML=this.config.pageSizeOptions.map((function(t){return"<option ".concat(e.size===t?"selected":"",">").concat(t,"</option>")})).join(""),this.labels.itemsPerPageLabel.innerHTML=this.config.itemsPerPageLabel+(this.config.showPageSizeOptions?"":this.size),[this.labels.itemsPerPageLabel,this.config.showPageSizeOptions?this.actions.selectPageSize:null].filter((function(e){return null!==e})).forEach((function(t){return e.panels.pageSizePanel.appendChild(t)})),[this.labels.rangeLabel,this.config.showFirstLastButtons?this.actions.btnFirst:null,this.actions.btnPrev,this.config.pageRadius>1?this.panels.pagesPanel:null,this.actions.btnNext,this.config.showFirstLastButtons?this.actions.btnLast:null].filter((function(e){return null!==e})).forEach((function(t){return e.panels.actionsPanel.appendChild(t)})),[this.config.hidePageSize?null:this.panels.pageSizePanel,this.panels.actionsPanel].filter((function(e){return null!==e})).forEach((function(t){return e.container.firstElementChild.appendChild(t)}))},e.prototype[g]=function(){this.labels.rangeLabel.innerHTML=this.config.getRangeLabel(this.currentPage,this.size,this.pages,this.length)},e.prototype[p]=function(e,t,a){if(this.disabled){if(Object.values(this.actions).forEach((function(e){return e.disabled=!0})),this.config.pageRadius<2)return;return"select"===this.config.pageNumbersType?void(this.panels.pagesPanel.disabled=!0):void this.pageNumberButtons.forEach((function(e){return e.disabled=!0}))}var i=e<=1,n=t<=1||e===t;if(this.actions.selectPageSize.disabled=a<=0,this.actions.btnFirst.disabled=i,this.actions.btnPrev.disabled=i,this.actions.btnNext.disabled=n,this.actions.btnLast.disabled=n,!(this.config.pageRadius<2))if("select"!==this.config.pageNumbersType)for(var s=this.pageNumberButtons,r=s.length,o=0;o<r;o++)0!==o?o!==r-1?o!==this.pageNumbers.indexOf(e)?s[o].disabled=!1:s[o].disabled=!0:s[o].disabled=n:s[o].disabled=i;else this.panels.pagesPanel.disabled=!1},e}(),b=function(){function e(){}return e.prototype.request=function(e,a,i){return new Promise((function(n,s){var r=(i.method||"GET").toUpperCase(),o=e,c={method:i.method,headers:i.headers};if("GET"===r){var h=Object.assign({},i.data,a);o=o+(e.includes("?")?"&":"?")+new URLSearchParams(h)}else if("POST"===r)if(i.data instanceof FormData){var u=new FormData;i.data.forEach((function(e,t){return u.set(t,e)})),Object.keys(a).forEach((function(e){return u.set(e,a[e])})),c.body=u}else{var p=i.headers["Content-Type"]||t.URL_ENCODED;if(p===t.FORM_DATA){var g=new FormData;Object.keys(i.data).forEach((function(e){return g.set(e,i.data[e])})),Object.keys(a).forEach((function(e){return g.set(e,a[e])})),c.body=g}else{h=Object.assign({},i.data,a);p===t.URL_ENCODED?c.body=new URLSearchParams(h):p===t.JSON&&(c.body=JSON.stringify(h))}}i.before(c),fetch(o,c).then((function(e){e.ok?e.json().then(n):s(e.status+": "+(e.statusText||"request failed."))})).catch(s)}))},e}(),P=d.init;e.ContentType=t,e.FetchAdapter=b,e.Paginator=d,e.XMLHttpRequestAdapter=a,e.createElement=h,e.init=P}));
//# sourceMappingURL=axpager.umd.min.js.map

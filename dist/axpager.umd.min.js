!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).axpager={})}(this,(function(e){"use strict";var t={JSON:"application/json",URL_ENCODED:"application/x-www-form-urlencoded",FORM_DATA:"multipart/form-data"},a=function(e,t){void 0===t&&(t={});var a=document.createElement(e);return Object.keys(t).forEach((function(e){a[e]=t[e]})),a},i=function(e){var t=new URLSearchParams;return e?(Object.keys(e).forEach((function(a){t.set(a,e[a])})),t):t},n=function(){function e(){}return e.prototype.request=function(e,a,n){var s=this;return new Promise((function(r,o){s.xhr&&4!==s.xhr.readyState&&s.xhr.abort(),s.xhr=new XMLHttpRequest,s.xhr.responseType="json",Object.keys(n.headers).forEach((function(e){s.xhr.setRequestHeader(e,n.headers[e])})),n.before(s.xhr),s.xhr.onload=function(){4===this.readyState&&this.status>=200&&this.status<300?r(this.response):o(this.status+": "+(this.statusText||"request failed."))},n.timeout&&n.timeout>=0&&(s.xhr.timeout=n.timeout,s.xhr.ontimeout=function(){o("408: request timeout, request wait time > "+this.timeout)}),s.xhr.onerror=function(){o(this.status+": "+(this.statusText||"server error."))};var c=(n.method||"GET").toUpperCase();if("GET"===c){var u=Object.assign({},n.data,a),h=e.includes("?")?"&":"?",g=e+h+i(u);return s.xhr.open(c,g,!0),void s.xhr.send()}if("POST"===c){if(s.xhr.open(c,e,!0),n.data instanceof FormData){var p=new FormData;return n.data.forEach((function(e,t){return p.set(t,e)})),Object.keys(a).forEach((function(e){return p.set(e,a[e])})),void s.xhr.send(p)}var l=n.headers["Content-Type"]||t.URL_ENCODED;if(l===t.FORM_DATA){var f=new FormData;return Object.keys(n.data).forEach((function(e){return f.set(e,n.data[e])})),Object.keys(a).forEach((function(e){return f.set(e,a[e])})),void s.xhr.send(f)}u=Object.assign({},n.data,a);if(l===t.URL_ENCODED)return void s.xhr.send(i(u));if(l===t.JSON)return void s.xhr.send(JSON.stringify(u));s.xhr.abort(),o("Not support Content-Type: "+l)}o("Not support "+c+" method.")}))},e}(),s={itemsPerPageLabel:"每页条数 ",firstPageLabel:"第一页",previousPageLabel:"上一页",nextPageLabel:"下一页",lastPageLabel:"最后一页",hidePageSize:!1,showFirstLastButtons:!0,showPageSizeOptions:!0,initPageNumber:1,initPageSize:10,pageRadius:0,pageNumbersType:"button",pageSizeOptions:[10,15,30],ajaxAdapter:new n,getRangeLabel:function(e,t,a,i){return"第".concat(e,"/").concat(a,"页，共").concat(i,"条")},getPageParams:function(e,t){return{page:e,size:t}},getPagedResource:function(e){return{data:e.data,length:e.pager.recordCount}},changes:function(e,t){}},r={method:"GET",data:{},headers:{},timeout:-1,before:function(e){},success:function(e,t,a){},error:function(e){},finish:function(){},filter:function(e,t){return!0}},o='<svg viewBox="0 0 24 24" focusable="false" class="axp-icon"><path d="M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"></path></svg>',c='<svg viewBox="0 0 24 24" focusable="false" class="axp-icon"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg>',u='<svg viewBox="0 0 24 24" focusable="false" class="axp-icon"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg>',h='<svg viewBox="0 0 24 24" focusable="false" class="axp-icon"><path d="M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"></path></svg>',g=Symbol("initDomElements"),p=Symbol("updateActionStatus"),l=Symbol("updateRangeLabel"),f=Symbol("updateCurrent"),d=Symbol("calcPageNumbers"),b=function(){function e(e,t){var i=this;this.config={},this.pageNumberButtons=[],this.previousPage=1,this.currentPage=1,this.length=0,this.size=0,this.pageNumbers=[],this.disabled=!1,this.container=e,this.config=Object.assign({},s,t),this.currentPage="number"!=typeof this.config.initPageNumber||this.config.initPageNumber<1?1:this.config.initPageNumber,this.size=this.config.pageSizeOptions.includes(this.config.initPageSize)?this.config.initPageSize:this.config.pageSizeOptions[0]||10,this.actions={selectPageSize:a("SELECT",{className:"axp-select axp-size-options",disabled:!0}),btnFirst:a("BUTTON",{type:"button",title:this.config.firstPageLabel,innerHTML:"".concat(o,'<span class="axp-btn-touch-target"></span>'),className:"axp-btn",disabled:!0}),btnPrev:a("BUTTON",{type:"button",title:this.config.previousPageLabel,innerHTML:"".concat(c,'<span class="axp-btn-touch-target"></span>'),className:"axp-btn",disabled:!0}),btnNext:a("BUTTON",{type:"button",title:this.config.nextPageLabel,innerHTML:"".concat(u,'<span class="axp-btn-touch-target"></span>'),className:"axp-btn",disabled:!0}),btnLast:a("BUTTON",{type:"button",title:this.config.lastPageLabel,innerHTML:"".concat(h,'<span class="axp-btn-touch-target"></span>'),className:"axp-btn",disabled:!0})},this.labels={itemsPerPageLabel:a("SPAN",{className:"axp-label axp-items-per-page"}),rangeLabel:a("SPAN",{className:"axp-label axp-range"})},this.panels={pageSizePanel:a("DIV",{className:"axp-page-size"}),actionsPanel:a("DIV",{className:"axp-range-actions"}),pagesPanel:"select"===this.config.pageNumbersType?a("SELECT",{className:"axp-select axp-page-numbers",disabled:!0}):a("DIV",{className:"axp-pages"})},this.panels.actionsPanel.addEventListener("click",(function(e){if(!i.disabled){var t=e.target;if(t.classList.contains("axp-btn-touch-target")&&(t=t.parentElement),null!=t&&!t.disabled){var a=i.actions,n=!0;switch(t){case a.btnFirst:if(1===i.currentPage){n=!1;break}i.previousPage=i.currentPage,i.currentPage=1;break;case a.btnPrev:if(1===i.currentPage){n=!1;break}i.previousPage=i.currentPage,i.currentPage=i.currentPage>1?i.currentPage-1:1;break;case a.btnNext:var s=i.pages;if(i.currentPage===s){n=!1;break}i.previousPage=i.currentPage;var r=i.currentPage+1;i.currentPage=r>s?s:r;break;case a.btnLast:var o=i.pages;if(i.currentPage===o){n=!1;break}i.previousPage=i.currentPage,i.currentPage=o;break;default:if("select"!==i.config.pageNumbersType&&i.config.pageRadius>1){var c=i.pageNumberButtons.indexOf(t);if(c>-1){if(i.currentPage===i.pageNumbers[c]){n=!1;break}i.previousPage=i.currentPage,i.currentPage=i.pageNumbers[c];break}}n=!1}n&&(i.config.changes(i.pageEvent,t),i.of(i.target,i.option))}}})),this.actions.selectPageSize.addEventListener("change",(function(e){if(!i.disabled){var t=e.target;if(!t.disabled){i.previousPage=i.currentPage;var a=t.options.selectedIndex;i.size=i.config.pageSizeOptions[a]||10;var n=i.pages;i.currentPage>n&&(i.currentPage=n),i.config.changes(i.pageEvent,e.target),i.of(i.target,i.option)}}})),"select"===this.config.pageNumbersType&&this.config.pageRadius>1&&this.panels.pagesPanel.addEventListener("change",(function(e){if(!i.disabled){var t=e.target;if(!t.disabled){i.previousPage=i.currentPage;var a=t.options.selectedIndex;i.currentPage=i.pageNumbers[a],i.config.changes(i.pageEvent,e.target),i.of(i.target,i.option)}}})),this[g]()}return Object.defineProperty(e.prototype,"pages",{get:function(){if(this.length<=1)return 1;var e=this.length/this.size;if(e<=1)return 1;var t=Math.floor(e);return t===e?t:t+1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageParams",{get:function(){return this.config.getPageParams(this.currentPage,this.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageEvent",{get:function(){var e=this.currentPage*this.size;return{previousPage:this.previousPage,page:this.currentPage,size:this.size,start:(this.currentPage-1)*this.size,end:e>this.length?this.length:e,pages:this.pages,length:this.length}},enumerable:!1,configurable:!0}),e.init=function(t,a){return new e(t,a)},e.prototype.ajax=function(e,t){var a=this;if(!this.disabled){if("string"!=typeof e)throw Error("Request url is required.");this.target=e,this.option=Object.assign({},r,t);var i={method:this.option.method,data:this.option.data,headers:this.option.headers,timeout:this.option.timeout,before:this.option.before},n=this.config.ajaxAdapter.request(this.target,this.pageParams,i).then((function(e){var t=a.config.getPagedResource(e),i=t.data,n=t.length;a[f](n);var s=a.pageEvent;a.option.success(i,s,a.option.data),a[p](s.page,s.pages,s.length),a[l]()}));"function"!=typeof n.finally?n.then((function(){return a.option.finish()})).catch(this.option.error):n.catch(this.option.error).finally(this.option.finish)}},e.prototype.resource=function(e,t){var a=this;if(!this.disabled){if(!(e instanceof Array))throw Error("data must be an Array.");this.target=e,this.option=Object.assign({},r,t),this.option.before(null);var i=this.target.filter((function(e){return a.option.filter(e,a.option.data)}));this[f](i.length);var n=this.pageEvent,s=i.slice(n.start,n.end);this.option.success(s,n,this.option.data),this[p](n.page,n.pages,n.length),this[l](),this.option.finish()}},e.prototype.of=function(e,t){if("string"!=typeof e){if(!(e instanceof Array))throw Error(e+" can not be paging.");this.resource(e,t)}else this.ajax(e,t)},e.prototype.refresh=function(){this.of(this.target,this.option)},e.prototype.goto=function(e){if(!this.disabled){if("number"!=typeof e)throw Error("page must be number.");if(this.previousPage=this.currentPage,e<1)this.currentPage=1;else{var t=this.pages;this.currentPage=e>t?t:e}this.refresh()}},e.prototype.disable=function(e){this.disabled=e,this[p](this.currentPage,this.pages,this.length)},e.prototype[d]=function(){if("number"!=typeof this.config.pageRadius)throw Error("pageRadius must be number.");if(this.config.pageRadius<2)return[];var e=this.pages,t=this.currentPage-this.config.pageRadius,a=this.currentPage+this.config.pageRadius;t<=0&&(a-=t-1),a>e&&(t-=a-e-1);var i=[];do{t>0&&t<=e&&i.push(t)}while(++t<a);return i},e.prototype[f]=function(e){var t=this;this.length=e;var i=this.pages;this.currentPage=this.currentPage>i?i:this.currentPage,this.config.pageRadius<2||(this.pageNumbers=this[d](),"select"!==this.config.pageNumbersType?(this.panels.pagesPanel.innerHTML="",this.pageNumberButtons=this.pageNumbers.map((function(e){var i=a("BUTTON",{type:"button",className:"axp-btn".concat(e===t.currentPage?" axp-btn-current":""),innerHTML:"".concat(e,'<span class="axp-btn-touch-target"></span>')});return t.panels.pagesPanel.appendChild(i),i}))):this.panels.pagesPanel.innerHTML=this.pageNumbers.map((function(e){return"<option ".concat(e===t.currentPage?"selected":"",">").concat(e,"</option>")})).join(""))},e.prototype[g]=function(){var e=this;this.container.innerHTML='<div class="ax-pager"></div>',this.actions.selectPageSize.innerHTML=this.config.pageSizeOptions.map((function(t){return"<option ".concat(e.size===t?"selected":"",">").concat(t,"</option>")})).join(""),this.labels.itemsPerPageLabel.innerHTML=this.config.itemsPerPageLabel+(this.config.showPageSizeOptions?"":this.size),[this.labels.itemsPerPageLabel,this.config.showPageSizeOptions?this.actions.selectPageSize:null].filter((function(e){return null!==e})).forEach((function(t){return e.panels.pageSizePanel.appendChild(t)})),[this.labels.rangeLabel,this.config.showFirstLastButtons?this.actions.btnFirst:null,this.actions.btnPrev,this.config.pageRadius>1?this.panels.pagesPanel:null,this.actions.btnNext,this.config.showFirstLastButtons?this.actions.btnLast:null].filter((function(e){return null!==e})).forEach((function(t){return e.panels.actionsPanel.appendChild(t)})),[this.config.hidePageSize?null:this.panels.pageSizePanel,this.panels.actionsPanel].filter((function(e){return null!==e})).forEach((function(t){return e.container.firstElementChild.appendChild(t)}))},e.prototype[l]=function(){this.labels.rangeLabel.innerHTML=this.config.getRangeLabel(this.currentPage,this.size,this.pages,this.length)},e.prototype[p]=function(e,t,a){var i=this;if(this.disabled){if(Object.keys(this.actions).forEach((function(e){return i.actions[e].disabled=!0})),this.config.pageRadius<2)return;return"select"===this.config.pageNumbersType?void(this.panels.pagesPanel.disabled=!0):void this.pageNumberButtons.forEach((function(e){return e.disabled=!0}))}var n=e<=1,s=t<=1||e===t;if(this.actions.selectPageSize.disabled=a<=0,this.actions.btnFirst.disabled=n,this.actions.btnPrev.disabled=n,this.actions.btnNext.disabled=s,this.actions.btnLast.disabled=s,!(this.config.pageRadius<2))if("select"!==this.config.pageNumbersType)for(var r=this.pageNumberButtons,o=r.length,c=0;c<o;c++)0!==c?c!==o-1?c!==this.pageNumbers.indexOf(e)?r[c].disabled=!1:r[c].disabled=!0:r[c].disabled=s:r[c].disabled=n;else this.panels.pagesPanel.disabled=!1},e}(),P=function(){function e(){}return e.prototype.request=function(e,a,n){var s=this;return new Promise((function(r,o){var c=(n.method||"GET").toUpperCase(),u=e,h={method:n.method,headers:n.headers};if("GET"===c){var g=Object.assign({},n.data,a);u=u+(e.includes("?")?"&":"?")+i(g)}else if("POST"===c)if(n.data instanceof FormData){var p=new FormData;n.data.forEach((function(e,t){return p.set(t,e)})),Object.keys(a).forEach((function(e){return p.set(e,a[e])})),h.body=p}else{var l=n.headers["Content-Type"]||t.URL_ENCODED;if(l===t.FORM_DATA){var f=new FormData;Object.keys(n.data).forEach((function(e){return f.set(e,n.data[e])})),Object.keys(a).forEach((function(e){return f.set(e,a[e])})),h.body=f}else{g=Object.assign({},n.data,a);l===t.URL_ENCODED?h.body=i(g):l===t.JSON&&(h.body=JSON.stringify(g))}}s.controller&&s.controller.abort(),s.timeoutId>-1&&(window.clearTimeout(s.timeoutId),s.timeoutId=-1),n.timeout>=0&&(s.timeoutId=window.setTimeout((function(){s.controller&&s.controller.abort("408: request timeout, request wait time > "+n.timeout)}),n.timeout)),s.controller=new AbortController,h.signal=s.controller.signal,n.before(h),fetch(u,h).then((function(e){e.ok?e.json().then(r):o(e.status+": "+(e.statusText||"request failed."))})).catch(o)}))},e}(),m=b.init;e.ContentType=t,e.FetchAdapter=P,e.Paginator=b,e.XMLHttpRequestAdapter=n,e.init=m}));
//# sourceMappingURL=axpager.umd.min.js.map

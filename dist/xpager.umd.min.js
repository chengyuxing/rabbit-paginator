!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).xpager={})}(this,(function(t){"use strict";var e="application/json",i="application/x-www-form-urlencoded",n={itemsPerPageLabel:"每页条数",firstPageLabel:"第一页",previousPageLabel:"上一页",nextPageLabel:"下一页",lastPageLabel:"最后一页",hidePageSize:!1,showFirstLastButtons:!0,showPageSizeOptions:!0,pageSizeOptions:[10,15,30],getRangeLabel:function(t,e,i){return"第".concat(t,"/").concat(Math.floor(i/e+1),"页，共").concat(i,"条")},getPagedResource:function(t){return{data:t.data,length:t.pager.recordCount}},changes:function(t,e){}},a={method:"GET",data:{},headers:{},timeout:-1,before:function(t){},success:function(t,e){},error:function(t){},finish:function(){},filter:function(t){return!0}},s='<svg viewBox="0 0 24 24" focusable="false" class="mat-icon"><path d="M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"></path></svg>',r='<svg viewBox="0 0 24 24" focusable="false" class="mat-icon"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg>',o='<svg viewBox="0 0 24 24" focusable="false" class="mat-icon"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg>',c='<svg viewBox="0 0 24 24" focusable="false" class="mat-icon"><path d="M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"></path></svg>',h=function(t,e){void 0===e&&(e={});var i=document.createElement(t);return Object.keys(e).forEach((function(t){i[t]=e[t]})),i},l=Symbol("initDomElements"),g=Symbol("updateActionStatus"),u=Symbol("updateRangeLabel"),p=function(){function t(t,e){var i=this;this.config={},this.previousPage=1,this.currentPage=1,this.length=0,this.size=0,this.container=t,this.container.innerHTML='<div class="rabbit-pager"></div>',this.config=Object.assign({},n,e),this.size=this.config.pageSizeOptions[0]||10,this.actions={selectPageSize:h("SELECT",{className:"mat-select mat-size-options",disabled:!0}),btnFirst:h("BUTTON",{type:"button",title:this.config.firstPageLabel,innerHTML:"".concat(s,'<span class="mat-btn-touch-target"></span>'),className:"mat-btn",disabled:!0}),btnPrev:h("BUTTON",{type:"button",title:this.config.previousPageLabel,innerHTML:"".concat(r,'<span class="mat-btn-touch-target"></span>'),className:"mat-btn",disabled:!0}),btnNext:h("BUTTON",{type:"button",title:this.config.nextPageLabel,innerHTML:"".concat(o,'<span class="mat-btn-touch-target"></span>'),className:"mat-btn",disabled:!0}),btnLast:h("BUTTON",{type:"button",title:this.config.lastPageLabel,innerHTML:"".concat(c,'<span class="mat-btn-touch-target"></span>'),className:"mat-btn",disabled:!0})},this.labels={itemsPerPageLabel:h("SPAN",{className:"mat-label mat-items-per-page"}),rangeLabel:h("SPAN",{className:"mat-label mat-range"})},this.panels={pageSizePanel:h("DIV",{className:"mat-page-size"}),actionsPanel:h("DIV",{className:"mat-range-actions"})},this.container.addEventListener("click",(function(t){var e=t.target;if(null!=e&&("mat-btn-touch-target"===e.className&&(e=e.parentElement),!e.disabled)){var n=i.actions,a=!0;switch(i.previousPage=i.currentPage,e){case n.btnFirst:i.currentPage=1;break;case n.btnPrev:i.currentPage=i.currentPage>1?i.currentPage-1:1;break;case n.btnNext:var s=i.currentPage+1,r=i.pages;i.currentPage=s>r?r:s;break;case n.btnLast:i.currentPage=i.pages;break;default:a=!1}a&&(i.config.changes(i.pageEvent,e),i.of(i.target,i.option))}})),this.actions.selectPageSize.addEventListener("change",(function(t){i.previousPage=i.currentPage,i.size=+t.target.value||10;var e=i.pages;i.currentPage>e&&(i.currentPage=e),i.config.changes(i.pageEvent,t.target),i.of(i.target,i.option)})),this[l]()}return Object.defineProperty(t.prototype,"pages",{get:function(){return Math.floor(this.length/this.size)+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageParams",{get:function(){return{page:this.currentPage,size:this.size}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageEvent",{get:function(){var t=this.currentPage*this.size;return{previousPage:this.previousPage,page:this.currentPage,size:this.size,start:(this.currentPage-1)*this.size,end:t>this.length?this.length:t,pages:this.pages,length:this.length}},enumerable:!1,configurable:!0}),t.init=function(e,i){return new t(e,i)},t.prototype[l]=function(){var t=this;this.actions.selectPageSize.innerHTML=this.config.pageSizeOptions.map((function(t){return'<option value="'.concat(t,'">').concat(t,"</option>")})).join(""),this.labels.itemsPerPageLabel.innerHTML=this.config.itemsPerPageLabel+(this.config.showPageSizeOptions?"":this.config.pageSizeOptions[0]||10),[this.labels.itemsPerPageLabel,this.config.showPageSizeOptions?this.actions.selectPageSize:null].filter((function(t){return null!==t})).forEach((function(e){return t.panels.pageSizePanel.appendChild(e)})),[this.labels.rangeLabel,this.config.showFirstLastButtons?this.actions.btnFirst:null,this.actions.btnPrev,this.actions.btnNext,this.config.showFirstLastButtons?this.actions.btnLast:null].filter((function(t){return null!==t})).forEach((function(e){return t.panels.actionsPanel.appendChild(e)})),[this.config.hidePageSize?null:this.panels.pageSizePanel,this.panels.actionsPanel].filter((function(t){return null!==t})).forEach((function(e){return t.container.firstElementChild.appendChild(e)}))},t.prototype.ajax=function(t,n){var s=this;if("string"!=typeof t)throw Error("Request url is required.");var r=this;this.target=t,this.option=Object.assign({},a,n),this.xhr||(this.xhr=new XMLHttpRequest,Object.keys(this.option.headers).forEach((function(t){s.xhr.setRequestHeader(t,s.option.headers[t])})),this.xhr.responseType="json",this.xhr.addEventListener("load",(function(){if(200===this.status){var t=r.config.getPagedResource(this.response),e=t.data,i=t.length;r.length=i;var n=r.pageEvent;return r.option.success(e,n),r[g](n.page,n.pages,n.length),void r[u]()}r.option.error(new Error(this.status+": request failed, "+this.statusText))})),this.option.timeout&&this.option.timeout>=0&&(this.xhr.timeout=this.option.timeout,this.xhr.addEventListener("timeout",(function(){r.option.error(new Error("408: request timeout, request wait time > "+this.timeout))}))),this.xhr.addEventListener("error",(function(){r.option.error(new Error("500: request error, "+this.statusText))})),this.xhr.addEventListener("loadend",(function(){r.option.finish()}))),4!==this.xhr.readyState&&this.xhr.abort();var o=(this.option.method||"GET").toLowerCase();if(this.option.before(this.xhr),"get"===o){var c=Object.assign({},this.option.data,this.pageParams),h=this.target.includes("?")?"&":"?",l=this.target+h+new URLSearchParams(c);return this.xhr.open(o,l,!0),void this.xhr.send()}if("post"===o){if(this.xhr.open(o,this.target,!0),this.option.data instanceof FormData){var p=new FormData;this.option.data.forEach((function(t,e){return p.set(e,t)}));var f=this.pageParams;return Object.keys(f).forEach((function(t){return p.set(t,f[t])})),void this.xhr.send(p)}c=Object.assign({},this.option.data,this.pageParams);var b=this.option.headers["Content-Type"]||i;if(b===i)return void this.xhr.send(new URLSearchParams(c).toString());if(b===e)return void this.xhr.send(JSON.stringify(c));throw Error("Not support Content-Type: "+b)}throw Error("Not support "+o+" method.")},t.prototype.resource=function(t,e){var i=this;if(!(t instanceof Array))throw Error("data must be an Array.");this.target=t||[],this.option=Object.assign({},a,e),this.length=this.target.length,this.option.before(null);var n=this.target.filter((function(t){return i.option.filter(t)})),s=this.pageEvent,r=n.slice(s.start,s.end);this.option.success(r,s),this[g](s.page,s.pages,s.length),this[u](),this.option.finish()},t.prototype.of=function(t,e){if("string"!=typeof t){if(!(t instanceof Array))throw Error(t+" can not be paging.");this.resource(t,e)}else this.ajax(t,e)},t.prototype.refresh=function(){this.of(this.target,this.option)},t.prototype[u]=function(){this.labels.rangeLabel.innerHTML=this.config.getRangeLabel(this.currentPage,this.size,this.length)},t.prototype[g]=function(t,e,i){var n=1===t,a=1===e||t===e,s="mat-btn".concat(n?"":" mat-ripple-btn"),r="mat-btn".concat(a?"":" mat-ripple-btn");this.actions.selectPageSize.disabled=0===i,this.actions.btnFirst.disabled=n,this.actions.btnFirst.className=s,this.actions.btnPrev.disabled=n,this.actions.btnPrev.className=s,this.actions.btnNext.disabled=a,this.actions.btnNext.className=r,this.actions.btnLast.disabled=a,this.actions.btnLast.className=r},t}(),f=p.init;t.Paginator=p,t.createElement=h,t.init=f}));
//# sourceMappingURL=xpager.umd.min.js.map
